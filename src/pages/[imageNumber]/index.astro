---
/*
Project structure (inside src):

src/
├── layouts/
│   └── Layout.astro        // Base layout shared across pages
│
└── pages/
    └── [imageNumber]/      // Dynamic route parameter
        └── index.astro     // Renders /:imageNumber
*/

import Layout from '@/layouts/Layout.astro';
const { imageNumber } = Astro.params;
const hostname = '20essentials.github.io';
const pathname = `/project-000-420/assets/fr-${imageNumber}.avif`;
const urlImage = `https://${hostname}${pathname}`;

/*
To enable SPA-style navigation (client-side routing),
add Astro Transitions to your main layout.

In Layout.astro:

---
import { ClientRouter } from "astro:transitions";
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    ...
    <ClientRouter />
  </head>
  <body>
    <slot />
  </body>
</html>
*/
---

<Layout>
  <section class='bg' style={`--bg: url(${urlImage})`}></section>
  <aside class='container-circles'>
    {
      Array.from({ length: 7 }, (_, i) => {
        const currentIndex = i + 1;
        return (
          <a
            href={`/${currentIndex}`}
            class={`n${currentIndex} ${currentIndex === +imageNumber! ? 'active' : ''}`}
          />
        );
      })
    }
  </aside>
</Layout>

<style is:global>
  *,
  *::after,
  *::before {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    -webkit-tap-highlight-color: transparent;
  }

  body {
    height: 100vh;
    width: 100%;
    overflow: hidden;
    position: relative;
  }

  .bg {
    position: fixed;
    inset: 0;
    background-image: var(--bg);
    background-size: cover;
    background-position: center;
  }

  .container-circles {
    position: absolute;
    left: 50%;
    width: 200px;
    height: 50px;
    display: flex;
    gap: 0.5rem;
    bottom: 0em;
    justify-content: center;
    transform: translateX(-50%);
    z-index: 100;

    a {
      width: 15px;
      height: 15px;
      aspect-ratio: 1;
      border-radius: 50%;
      border: 0.2vw solid white;

      &.active {
        background-color: white;
      }
    }
  }

  @view-transition {
    navigation: auto;
  }

  body {
    view-transition-name: sliderViewTransition;
  }

  ::view-transition-old(sliderViewTransition) {
    animation: bgAnimate 0.5s ease forwards;
  }
  ::view-transition-new(sliderViewTransition) {
    animation: bgAnimate 0.5s ease reverse;
  }

  @keyframes bgAnimate {
    0% {
      filter: invert(1);
      mix-blend-mode: color;
    }
    100% {
      filter: invert(0);
      mix-blend-mode: difference;
    }
  }
</style>
